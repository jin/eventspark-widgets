{
  "name": "Live Chat",
  "encoded_embed_code": "%3Cdiv%20class%3D%22chat%22%3E%0A%20%20%3Cdiv%20class%3D%22chat-overlay%22%3EConnecting...%3C%2Fdiv%3E%0A%20%20%3Cdiv%20class%3D%22chat-logs%22%3E%0A%20%20%20%20%3Cdiv%20class%3D%22logs%22%3E%0A%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3Ctextarea%20placeholder%3D%22Send%20a%20message%22%20class%3D%22message-box%22%20maxlength%3D%22500%22%20disabled%3E%3C%2Ftextarea%3E%0A%20%20%3C%2Fdiv%3E%0A%3C%2Fdiv%3E%0A%3Cscript%3E%0A%24(function()%20%7B%0A%20%20initChat()%3B%0A%7D)%3B%0A%0Afunction%20unsubscribeChat()%20%7B%0A%20%20pubnub.unsubscribe(%7B%0A%20%20%20%20channel%20%3A%20%20%22griddit-chat%22%20window.location.href.hashCode()%0A%20%20%7D)%3B%0A%7D%0A%0Afunction%20initChat()%20%7B%0A%20%20var%20chat_username%20%3D%20typeof%20username%20!%3D%3D%20%22undefined%22%3F%20username%3A%20%22Guest_%22%20Math.floor((Math.random()%20*%2010000)%20%20%201)%3B%0A%20%20var%20colors%20%3D%20%5B%22d-re%22%2C%22l-bl%22%2C%22mage%22%2C%22red%22%2C%22pink%22%2C%22blue%22%2C%22teal%22%2C%22oran%22%2C%22d-pu%22%5D%3B%0A%20%20var%20color%20%3D%20colors%5BMath.floor(Math.random()%20*%20colors.length)%5D%3B%0A%0A%20%20function%20htmlEncode(%20html%20)%20%7B%0A%20%20%20%20return%20document.createElement(%20%22a%22%20).appendChild(%20%0A%20%20%20%20%20%20document.createTextNode(%20html%20)%20).parentNode.innerHTML%3B%0A%20%20%7D%3B%0A%0A%20%20Date.prototype.timeNow%20%3D%20function%20()%20%7B%0A%20%20%20%20return%20((this.getHours()%20%3C%2010)%3F%220%22%3A%22%22)%20%20%20this.getHours()%20%20%22%3A%22%20%20((this.getMinutes()%20%3C%2010)%3F%220%22%3A%22%22)%20%20%20this.getMinutes()%20%20%22%3A%22%20%20((this.getSeconds()%20%3C%2010)%3F%220%22%3A%22%22)%20%20%20this.getSeconds()%3B%0A%20%20%7D%0A%20%20function%20getTime()%20%7B%0A%20%20%20%20var%20currentTime%20%3D%20new%20Date().timeNow()%3B%0A%20%20%20%20return%20currentTime%3B%0A%20%20%7D%0A%0A%20%20function%20insertMessage(%20message%20)%20%7B%0A%20%20%20%20var%20elem%20%3D%20%24(%22.logs%22)%3B%0A%20%20%20%20var%20atBottom%20%3D%20(elem%5B0%5D.scrollHeight%20-%20elem.scrollTop()%20%3C%3D%20elem.outerHeight()%20%20%2020%20)%3B%0A%20%20%20%20%24(%22.logs%22).append(message)%3B%20%0A%20%20%20%20if%20(atBottom)%20%7B%0A%20%20%20%20%20%20elem.scrollTop(elem%5B0%5D.scrollHeight)%3B%0A%20%20%20%20%7D%0A%20%20%7D%3B%0A%20%20%24(%22.message-box%22).on(%22keypress%22%2C%20function(event)%20%7B%0A%20%20%20%20var%20key%20%3D%20event.keyCode%3B%0A%20%20%20%20var%20message%20%3D%20%24.trim(%24(%22.message-box%22).val())%3B%0A%20%20%20%20if%20(key%20%3D%3D%2013%20%26%26%20!event.shiftKey%20%26%26%20message%20!%3D%3D%20%22%22)%20%7B%0A%20%20%20%20%20%20pubnub.publish(%7B%0A%20%20%20%20%20%20%20%20channel%20%3A%20%20%22griddit-chat%22%20window.location.href.hashCode()%2C%0A%20%20%20%20%20%20%20%20message%20%3A%20%5Bchat_username%2Cmessage%2Ccolor%5D%0A%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%24(%22.message-box%22).val(%22%22)%3B%0A%20%20%20%20%20%20event.preventDefault()%3B%0A%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20else%20%7B%0A%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%7D%3B%0A%20%20%7D)%3B%0A%0A%20%20function%20connected(m)%20%7B%0A%20%20%20%20%24(%27.chat-overlay%27).hide()%3B%0A%20%20%20%20%24(%27.message-box%27).prop(%22disabled%22%2Cfalse)%3B%0A%20%20%20%20pubnub.history(%7B%0A%20%20%20%20%20%20channel%3A%20%22griddit-chat%22%20window.location.href.hashCode()%2C%0A%20%20%20%20%20%20callback%3A%20function(m)%7B%0A%20%20%20%20%20%20%20%20var%20startDate%20%3D%20new%20Date(parseInt(m%5B1%5D)%2F10000)%3B%0A%20%20%20%20%20%20%20%20var%20endDate%20%3D%20new%20Date(parseInt(m%5B2%5D)%2F10000)%3B%0A%20%20%20%20%20%20%20%20insertMessage(%22%3Cdiv%20class%3D%5C%22info%5C%22%3EShowing%20message%20history%20starting%20from%20%22%20startDate%20%22%3C%2Fdiv%3E%22)%3B%0A%20%20%20%20%20%20%20%20m%5B0%5D.forEach(function(msg)%20%7B%0A%20%20%20%20%20%20%20%20%20%20message(msg)%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20insertMessage(%22%3Cdiv%20class%3D%5C%22info%5C%22%3EEnd%20of%20message%20history%20from%20%22%20startDate%20%22%20to%20%22%20endDate%20%22.%3C%2Fdiv%3E%22)%3B%0A%20%20%20%20%20%20%20%20insertMessage(%22%3Cdiv%20class%3D%5C%22info%5C%22%3EWelcome%20to%20the%20chat%20room!%3C%2Fdiv%3E%22)%3B%20%0A%20%20%20%20%20%20%20%20insertMessage(%22%3Cdiv%20class%3D%5C%22info%5C%22%3EYou%20are%20%22%20chat_username%20%22.%20Login%20to%20get%20your%20own%20username!%3C%2Fdiv%3E%22)%3B%20%0A%20%20%20%20%20%20%7D%2C%0A%20%20count%3A%20100%2C%20%2F%2F%20100%20is%20the%20default%0A%20%20reverse%3A%20false%20%2F%2F%20false%20is%20the%20default%0A%7D)%3B%20%0A%20%20%7D%0A%0A%20%20function%20message(m)%20%7B%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20insertMessage(%22%3Cdiv%20class%3D%5C%22messages%5C%22%3E%3Cspan%20class%3D%5C%22time%5C%22%3E%22%20getTime()%20%22%3C%2Fspan%3E%3Cspan%20class%3D%5C%22author%20chat-%22%20htmlEncode(m%5B2%5D.substring(0%2C4))%20%22%5C%22%3E%22%20htmlEncode(m%5B0%5D.substring(0%2C20))%20%22%3C%2Fspan%3E%3A%20%22%20htmlEncode(m%5B1%5D.substring(0%2C500))%20%22%3C%2Fdiv%3E%22)%3B%0A%20%20%20%20%7D%20catch%20(e)%7B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20pubnub.subscribe(%7B%0A%20%20%20%20channel%20%3A%20%20%22griddit-chat%22%20window.location.href.hashCode()%2C%0A%20%20%20%20%27message%27%20%3A%20function(m)%20%7B%20message(m)%3B%20%7D%2C%0A%20%20%20%20%27connect%27%20%3A%20function(m)%20%7B%20connected(m)%3B%20%7D%2C%0A%20%20%20%20%27presence%27%20%3A%20function(m)%20%7B%0A%20%20%20%20%20%20if%20(m.action%20%3D%3D%3D%20%22join%22%20%26%26%20m.data)%20%7B%0A%20%20%20%20%20%20%20%20insertMessage(%22%3Cdiv%20class%3D%5C%22info%5C%22%3E%22%20htmlEncode(m.data.username.substring(0%2C20))%20%22%20has%20entered%20the%20chatroom!%3C%2Fdiv%3E%22)%3B%20%0A%20%20%20%20%20%20%7D%20else%20if%20(m.action%20%3D%3D%3D%20%22leave%22%20%7C%7C%20m.action%20%3D%3D%3D%20%22timeout%22)%20%7B%0A%20%20%20%20%20%20%20%20insertMessage(%22%3Cdiv%20class%3D%5C%22info%5C%22%3E%22%20htmlEncode(m.data.username.substring(0%2C20))%20%22%20has%20left%20the%20chatroom!%3C%2Fdiv%3E%22)%3B%20%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%2C%0A%20%20%20%20%27disconnect%27%20%3A%20function(m)%20%7B%0A%20%20%20%20%20%20insertMessage(%22%3Cdiv%20class%3D%5C%22info%5C%22%3EYou%27ve%20been%20disconnected!%3C%2Fdiv%3E%22)%3B%20%0A%20%20%20%20%7D%2C%0A%20%20%20%20%27reconnect%27%20%3A%20function(m)%20%7B%0A%20%20%20%20%20%20insertMessage(%22%3Cdiv%20class%3D%5C%22info%5C%22%3EYou%27ve%20been%20reconnected%20to%20the%20channel!%3C%2Fdiv%3E%22)%3B%20%0A%20%20%20%20%7D%2C%0A%20%20%20%20%27state%27%20%3A%20%7B%0A%20%20%20%20%20%20username%3A%20chat_username%0A%20%20%20%20%7D%0A%20%20%7D)%3B%20%0A%7D%0A%3C%2Fscript%3E%22%2C%0A",
  "image_url": "http://res.cloudinary.com/eventspark3216/image/upload/v1446467761/eventspark/widget-chat-medium.png",
  "image_thumb_url": "http://res.cloudinary.com/eventspark3216/image/upload/v1446467277/widget-chat-small_fawhkx.png",
  "variables": {
  }
}
